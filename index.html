<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pusat Alat Marching Band Batam & Kepri - PT. SVM (Official)</title>
    
    <!-- SEO Meta Tags Super -->
    <meta name="description" content="Distributor Resmi Alat Marching Band & Drumband Terbesar di Batam Kepulauan Riau. Jual Snare HTS, Brass, Seragam, & Jasa Pelatih Juara Internasional. Legalitas Lengkap, Bisa SIPLAH.">
    <meta name="keywords" content="toko marching band batam, jual alat drumband batam, distributor hts kepri, jasa pelatih drumband batam, service alat marching band batam, seragam drumband tanjung pinang, toko musik batam, pengadaan alat sekolah kepri, sparepart drumband batam, marching band karimun, marching band bintan">
    <meta name="author" content="PT. Svara Vanguard Management">
    <meta name="robots" content="index, follow">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- AOS Animation CSS -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,600;0,800;1,600&family=Oswald:wght@500;700&display=swap" rel="stylesheet">

    <!-- Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                        display: ['Oswald', 'sans-serif'],
                    },
                    colors: {
                        svm: {
                            dark: '#0B0F19', 
                            navy: '#151E2E',
                            gold: '#C5A059', 
                            goldlight: '#E5C585',
                            red: '#D90429'
                        }
                    },
                    backgroundImage: {
                        'music-pattern': "url('https://www.transparenttextures.com/patterns/cubes.png')",
                    },
                    animation: {
                        'float-slow': 'float 8s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Modern Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #0B0F19; }
        ::-webkit-scrollbar-thumb { background: #C5A059; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #E5C585; }

        body { background-color: #F8FAFC; color: #1E293B; }

        /* Glassmorphism Navigation */
        .glass-nav {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        /* Musical Wave Animation Background */
        .wave-bg {
            background: radial-gradient(circle at 50% 50%, rgba(197, 160, 89, 0.1) 0%, transparent 50%);
            animation: pulse-slow 5s infinite;
        }

        .active-tab { 
            background: #0B0F19; 
            color: #C5A059; 
            box-shadow: 0 4px 15px -3px rgba(0, 0, 0, 0.3);
            border: 1px solid #C5A059;
        }

        /* Text Gradients */
        .text-gradient-gold {
            background: linear-gradient(to right, #C5A059, #FDE68A, #C5A059);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-size: 200% auto;
            animation: shine 4s linear infinite;
        }
        @keyframes shine { to { background-position: 200% center; } }
        
        /* ADMIN MODE STYLES */
        .editable { outline: none; transition: all 0.2s; position: relative; border-radius: 4px; }
        body.admin-mode .editable { border: 1px dashed rgba(197, 160, 89, 0.5); cursor: text; padding: 2px; }
        body.admin-mode .editable:hover::after {
            content: 'âœŽ Edit'; position: absolute; top: -15px; right: 0; background: #C5A059; color: white; font-size: 9px; padding: 2px 6px; border-radius: 2px; pointer-events: none; z-index: 50;
        }
        
        /* Image Editing & Files */
        body.admin-mode .editable-img { cursor: pointer; border: 3px solid #C5A059 !important; z-index: 10; }
        body.admin-mode .img-container:hover::before {
            content: 'ðŸ“¸ GANTI FILE/FOTO'; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8); color: #C5A059; padding: 8px 12px; border-radius: 8px; 
            font-size: 10px; font-weight: bold; pointer-events: none; z-index: 20; text-align: center;
        }

        /* Link Editing Button */
        .edit-link-btn { display: none; }
        body.admin-mode .edit-link-btn { display: inline-flex; }

        #adminToolbar { display: none !important; }
        body.admin-mode #adminToolbar { display: flex !important; }

        /* Responsive Fixes */
        @media (max-width: 768px) {
            .hero-title { font-size: 2.5rem !important; line-height: 1.1 !important; }
            .section-padding { padding-top: 3rem; padding-bottom: 3rem; }
        }
    </style>
</head>
<body class="font-sans antialiased overflow-x-hidden bg-slate-50">

    <!-- NAVBAR -->
    <nav id="navbar" class="fixed w-full top-0 z-50 transition-all duration-300 py-2 md:py-4">
        <div class="max-w-7xl mx-auto px-4 md:px-8">
            <div class="glass-nav rounded-full px-4 md:px-6 py-2 md:py-3 flex justify-between items-center shadow-lg shadow-gray-200/50">
                <!-- Logo -->
                <div class="flex items-center gap-3 cursor-pointer group" onclick="router.navigate('home')">
                    <div class="bg-svm-dark text-svm-gold p-2 rounded-full group-hover:rotate-12 transition duration-300">
                        <i class="fa-solid fa-music text-lg"></i>
                    </div>
                    <div>
                        <h1 class="font-display font-bold text-lg md:text-xl leading-none tracking-tight text-svm-dark">SVM<span class="text-svm-gold">.ID</span></h1>
                    </div>
                </div>
                
                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center gap-1 bg-slate-100/50 rounded-full p-1 border border-white">
                    <button onclick="router.navigate('home')" class="px-5 py-2 rounded-full text-xs font-bold text-slate-600 hover:bg-white hover:text-svm-dark transition uppercase tracking-wide">Beranda</button>
                    <button onclick="router.navigate('training')" class="px-5 py-2 rounded-full text-xs font-bold text-slate-600 hover:bg-white hover:text-svm-dark transition uppercase tracking-wide">Pelatihan</button>
                    <button onclick="router.navigate('catalog')" class="px-5 py-2 rounded-full text-xs font-bold text-slate-600 hover:bg-white hover:text-svm-dark transition uppercase tracking-wide">Katalog</button>
                </div>

                <!-- Action -->
                <div class="flex items-center gap-2 md:gap-3">
                    <button onclick="window.open('https://wa.me/6283812113160', '_blank')" class="hidden md:flex bg-svm-dark hover:bg-slate-800 text-white px-5 py-2 rounded-full text-xs font-bold transition shadow-lg items-center gap-2">
                        <span>Konsultasi</span> <i class="fa-solid fa-whatsapp"></i>
                    </button>
                    <button id="btnLogin" onclick="ui.showLoginModal()" class="w-8 h-8 flex items-center justify-center rounded-full text-slate-400 hover:text-svm-dark transition" title="Admin">
                        <i class="fa-solid fa-lock text-xs"></i>
                    </button>
                    <div id="adminBadge" class="hidden items-center gap-2 bg-red-600 text-white px-3 py-1 rounded-full text-[10px] font-bold shadow-lg cursor-default tracking-wider">
                        ADMIN
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- MAIN APP CONTAINER -->
    <main id="app" class="min-h-screen pb-20 md:pb-0">

        <!-- === PAGE 1: BERANDA === -->
        <div id="page-home" class="page-section">
            
            <!-- Hero Section -->
            <section class="relative pt-28 md:pt-36 pb-10 md:pb-20 px-4 overflow-hidden">
                <!-- Background Accents -->
                <div class="absolute top-0 right-0 w-[500px] h-[500px] bg-svm-gold/10 rounded-full blur-3xl -z-10 translate-x-1/3 -translate-y-1/3 animate-pulse-slow"></div>
                <div class="absolute bottom-0 left-0 w-[300px] h-[300px] bg-blue-100 rounded-full blur-3xl -z-10 -translate-x-1/3 translate-y-1/3"></div>
                
                <div class="max-w-7xl mx-auto">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 items-center">
                        <div class="order-2 lg:order-1 text-center lg:text-left" data-aos="fade-up">
                            <div class="inline-flex items-center gap-2 bg-white border border-slate-200 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-widest mb-6 text-svm-gold shadow-sm">
                                <i class="fa-solid fa-star animate-spin-slow"></i>
                                <span class="editable" id="hero-badge">Distributor & Pelatih Resmi</span>
                            </div>
                            <h1 class="hero-title font-serif text-4xl md:text-7xl font-bold leading-tight mb-4 text-svm-dark">
                                <span class="editable" id="home-title-1">Harmoni</span> <br>
                                <span class="text-gradient-gold editable" id="home-title-2">Juara</span> <br>
                                <span class="editable" id="home-title-3">Kepulauan Riau.</span>
                            </h1>
                            <p class="editable text-sm md:text-lg text-slate-500 mb-8 leading-relaxed font-light" id="home-desc">
                                Jangan biarkan talenta siswa terpendam karena alat rusak. Kami hadirkan solusi alat marching band berstandar internasional dengan garansi servis penuh.
                            </p>
                            
                            <!-- DAILY MOTIVATION (AI) -->
                            <div class="bg-gradient-to-r from-svm-dark to-slate-900 p-4 rounded-xl mb-8 shadow-xl text-white relative overflow-hidden group">
                                <div class="absolute top-0 right-0 text-6xl text-white/5 font-serif italic pr-4">"</div>
                                <p id="dailyQuote" class="text-xs md:text-sm font-medium italic relative z-10 leading-relaxed">
                                    "Investasi alat musik adalah investasi karakter. Jadikan sekolah Anda pusat kreativitas Batam hari ini."
                                </p>
                                <div class="mt-2 flex justify-between items-center">
                                    <span class="text-[10px] text-svm-gold uppercase tracking-widest font-bold">Motivation of the Day</span>
                                    <button onclick="aiHelper.generateQuote()" class="admin-only hidden text-[10px] bg-white/10 hover:bg-white/20 px-2 py-1 rounded transition"><i class="fa-solid fa-wand-magic-sparkles text-yellow-400 mr-1"></i> AI Magic</button>
                                </div>
                            </div>

                            <div class="flex flex-wrap justify-center lg:justify-start gap-3">
                                <button onclick="router.navigate('catalog')" class="bg-svm-dark hover:bg-slate-800 text-white px-6 py-3 rounded-full font-bold transition shadow-lg shadow-slate-900/20 flex items-center gap-2 text-sm">
                                    <span>Cek Katalog</span> <i class="fa-solid fa-arrow-right"></i>
                                </button>
                                <button onclick="document.getElementById('legal-section').scrollIntoView()" class="bg-white border border-slate-200 text-slate-600 px-6 py-3 rounded-full font-bold transition hover:bg-slate-50 text-sm flex items-center gap-2">
                                    <i class="fa-solid fa-shield-halved text-svm-gold"></i> Legalitas
                                </button>
                            </div>
                        </div>
                        
                        <!-- Hero Image Frame -->
                        <div class="order-1 lg:order-2 relative" data-aos="zoom-in" data-aos-duration="1000">
                            <div class="absolute inset-0 bg-svm-gold rounded-[2rem] rotate-3 opacity-20 blur-lg"></div>
                            <div class="relative rounded-[2rem] overflow-hidden shadow-2xl border-4 border-white img-container h-[300px] md:h-[500px]">
                                <img id="hero-main-img" src="https://images.unsplash.com/photo-1544279762-2b638c4c3e80?q=80&w=1000" class="w-full h-full object-cover editable-img transform hover:scale-105 transition duration-1000">
                                
                                <!-- Float Player -->
                                <div class="absolute bottom-4 right-4 bg-white/90 backdrop-blur-md p-3 rounded-xl shadow-lg flex items-center gap-3 animate-float-slow max-w-[200px]">
                                    <div class="w-8 h-8 bg-svm-dark rounded-full flex items-center justify-center text-white text-xs">
                                        <i class="fa-solid fa-music"></i>
                                    </div>
                                    <div>
                                        <p class="text-[10px] font-bold text-svm-dark">Sound of Victory</p>
                                        <div class="w-20 h-1 bg-gray-200 rounded-full mt-1 overflow-hidden">
                                            <div class="w-2/3 h-full bg-svm-gold rounded-full"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Marquee Clients -->
            <div class="bg-svm-dark py-3 overflow-hidden mb-12 transform -skew-y-1">
                <div class="max-w-7xl mx-auto px-4 flex justify-between items-center text-slate-400 text-[10px] md:text-xs font-bold uppercase tracking-[0.2em] whitespace-nowrap gap-8 overflow-x-auto scrollbar-hide">
                    <span><i class="fa-solid fa-star text-svm-gold mr-1"></i> SMAN 20 Batam</span>
                    <span><i class="fa-solid fa-star text-svm-gold mr-1"></i> SVMC</span>
                    <span><i class="fa-solid fa-star text-svm-gold mr-1"></i> CK marching</span>
                    <span><i class="fa-solid fa-trophy text-svm-gold mr-1"></i> MIMAC Champion</span>
                </div>
            </div>

            <!-- LEGALITAS & DOKUMEN (Thumbnails + Link) -->
            <section id="legal-section" class="max-w-7xl mx-auto px-4 mb-20">
                <div class="text-center mb-10" data-aos="fade-up">
                    <h2 class="font-serif text-2xl md:text-3xl font-bold text-svm-dark mb-2 editable" id="legal-title">Legalitas & Kompetensi</h2>
                    <p class="text-xs md:text-sm text-slate-500 max-w-xl mx-auto editable" id="legal-sub">Transparansi dokumen legalitas perusahaan. Klik gambar untuk melihat file asli (PDF/Drive).</p>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4 md:gap-6">
                    <!-- Doc 1 -->
                    <div class="group relative bg-white p-3 md:p-4 rounded-2xl shadow-sm hover:shadow-xl border border-slate-100 transition duration-300" data-aos="fade-up" data-aos-delay="100">
                        <div class="h-32 md:h-48 rounded-xl overflow-hidden mb-3 bg-slate-50 img-container relative border border-slate-100">
                            <!-- Link Handler -->
                            <a href="#" id="cert-link-1" target="_blank" class="absolute inset-0 z-10 flex items-center justify-center bg-svm-dark/0 group-hover:bg-svm-dark/40 transition">
                                <span class="opacity-0 group-hover:opacity-100 bg-white text-svm-dark px-3 py-1 rounded-full text-[10px] font-bold shadow-lg transform scale-90 group-hover:scale-100 transition"><i class="fa-solid fa-eye"></i> Lihat PDF</span>
                            </a>
                            <img id="cert-img-1" src="https://via.placeholder.com/400x300.png?text=Preview+Izin+Usaha" class="w-full h-full object-cover editable-img">
                        </div>
                        <h4 class="font-bold text-sm md:text-base text-svm-dark editable" id="cert-title-1">Izin Usaha (NIB)</h4>
                        <p class="text-[10px] text-slate-500 editable truncate" id="cert-desc-1">Resmi Kemenkumham & OSS</p>
                        <button onclick="admin.editLink('cert-link-1')" class="admin-only hidden w-full mt-2 text-[10px] bg-slate-100 text-slate-600 py-1 rounded hover:bg-slate-200"><i class="fa-solid fa-link"></i> Edit Link PDF</button>
                    </div>

                    <!-- Doc 2 -->
                    <div class="group relative bg-white p-3 md:p-4 rounded-2xl shadow-sm hover:shadow-xl border border-slate-100 transition duration-300" data-aos="fade-up" data-aos-delay="200">
                        <div class="h-32 md:h-48 rounded-xl overflow-hidden mb-3 bg-slate-50 img-container relative border border-slate-100">
                            <a href="#" id="cert-link-2" target="_blank" class="absolute inset-0 z-10 flex items-center justify-center bg-svm-dark/0 group-hover:bg-svm-dark/40 transition">
                                <span class="opacity-0 group-hover:opacity-100 bg-white text-svm-dark px-3 py-1 rounded-full text-[10px] font-bold shadow-lg transform scale-90 group-hover:scale-100 transition"><i class="fa-solid fa-eye"></i> Lihat PDF</span>
                            </a>
                            <img id="cert-img-2" src="https://via.placeholder.com/400x300.png?text=Preview+Sertifikat+Pelatih" class="w-full h-full object-cover editable-img">
                        </div>
                        <h4 class="font-bold text-sm md:text-base text-svm-dark editable" id="cert-title-2">Sertifikat Pelatih</h4>
                        <p class="text-[10px] text-slate-500 editable truncate" id="cert-desc-2">Lisensi Internasional & MIMAC</p>
                        <button onclick="admin.editLink('cert-link-2')" class="admin-only hidden w-full mt-2 text-[10px] bg-slate-100 text-slate-600 py-1 rounded hover:bg-slate-200"><i class="fa-solid fa-link"></i> Edit Link PDF</button>
                    </div>

                    <!-- Doc 3 -->
                    <div class="group relative bg-white p-3 md:p-4 rounded-2xl shadow-sm hover:shadow-xl border border-slate-100 transition duration-300" data-aos="fade-up" data-aos-delay="300">
                        <div class="h-32 md:h-48 rounded-xl overflow-hidden mb-3 bg-slate-50 img-container relative border border-slate-100">
                            <a href="#" id="cert-link-3" target="_blank" class="absolute inset-0 z-10 flex items-center justify-center bg-svm-dark/0 group-hover:bg-svm-dark/40 transition">
                                <span class="opacity-0 group-hover:opacity-100 bg-white text-svm-dark px-3 py-1 rounded-full text-[10px] font-bold shadow-lg transform scale-90 group-hover:scale-100 transition"><i class="fa-solid fa-eye"></i> Lihat PDF</span>
                            </a>
                            <img id="cert-img-3" src="https://via.placeholder.com/400x300.png?text=Preview+Distributor" class="w-full h-full object-cover editable-img">
                        </div>
                        <h4 class="font-bold text-sm md:text-base text-svm-dark editable" id="cert-title-3">Surat Distributor</h4>
                        <p class="text-[10px] text-slate-500 editable truncate" id="cert-desc-3">Penunjukan Resmi Pabrikan</p>
                        <button onclick="admin.editLink('cert-link-3')" class="admin-only hidden w-full mt-2 text-[10px] bg-slate-100 text-slate-600 py-1 rounded hover:bg-slate-200"><i class="fa-solid fa-link"></i> Edit Link PDF</button>
                    </div>
                </div>
            </section>

            <!-- WHY US -->
            <section class="bg-slate-900 py-16 text-white relative overflow-hidden">
                <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')] opacity-20"></div>
                <div class="max-w-7xl mx-auto px-4 relative z-10">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
                        <div data-aos="fade-right">
                            <h2 class="font-serif text-2xl md:text-4xl font-bold mb-4">Mengapa Sekolah <br><span class="text-svm-gold">Memilih SVM?</span></h2>
                            <p class="text-slate-400 text-sm mb-8 leading-relaxed">Kami memahami bahwa sekolah membutuhkan alat yang awet dan layanan purna jual yang jelas, bukan sekadar barang murah yang cepat rusak.</p>
                            
                            <ul class="space-y-4 text-sm">
                                <li class="flex gap-3">
                                    <i class="fa-solid fa-check-circle text-svm-gold mt-1"></i>
                                    <div>
                                        <strong class="block text-white">Lifetime Support Teknisi</strong>
                                        <span class="text-slate-500 text-xs">Rusak? Teknisi kami datang ke sekolah.</span>
                                    </div>
                                </li>
                                <li class="flex gap-3">
                                    <i class="fa-solid fa-check-circle text-svm-gold mt-1"></i>
                                    <div>
                                        <strong class="block text-white">Harga Nego & Transparan</strong>
                                        <span class="text-slate-500 text-xs">Sesuai RAPBS sekolah & administrasi pajak beres.</span>
                                    </div>
                                </li>
                                <li class="flex gap-3">
                                    <i class="fa-solid fa-check-circle text-svm-gold mt-1"></i>
                                    <div>
                                        <strong class="block text-white">Kurikulum Juara</strong>
                                        <span class="text-slate-500 text-xs">Gratis konsultasi materi pelatihan 3 bulan pertama.</span>
                                    </div>
                                </li>
                            </ul>
                        </div>
                        <div class="h-64 md:h-80 rounded-2xl overflow-hidden border-2 border-svm-gold/30 relative img-container" data-aos="fade-left">
                            <div class="absolute inset-0 bg-gradient-to-t from-black to-transparent opacity-60 z-10"></div>
                            <img id="feature-img" src="https://images.unsplash.com/photo-1514525253440-b393452e8d26?q=80&w=800" class="w-full h-full object-cover editable-img">
                            <div class="absolute bottom-6 left-6 z-20">
                                <p class="font-serif text-xl italic text-white">"Musik adalah investasi karakter."</p>
                                <p class="text-[10px] text-svm-gold font-bold mt-1 uppercase tracking-widest">- Arif, Founder</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- YOUTUBE & ACTIVITIES -->
            <section class="py-16 bg-white relative">
                <div class="max-w-7xl mx-auto px-4">
                    <div class="flex justify-between items-end mb-8">
                        <div>
                            <h2 class="font-serif text-2xl font-bold text-svm-dark mb-1 editable" id="yt-title">Galeri Kegiatan</h2>
                            <p class="text-xs text-slate-500 editable" id="yt-desc">Latihan & Kompetisi.</p>
                        </div>
                        <button onclick="ui.showVideoModal()" class="admin-only hidden bg-red-600 text-white rounded-full w-8 h-8 hover:bg-red-700 transition flex items-center justify-center shadow-lg"><i class="fa-solid fa-plus text-xs"></i></button>
                    </div>
                    <div id="videoGrid" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <!-- JS Loaded -->
                    </div>
                </div>
            </section>
        </div>

        <!-- === PAGE 2: PELATIHAN === -->
        <div id="page-training" class="page-section hidden fade-in bg-white">
            <div class="h-[50vh] relative img-container">
                <div class="absolute inset-0 bg-svm-dark/70 z-10"></div>
                <img id="training-bg-img" src="https://images.unsplash.com/photo-1511192336575-5a79af67a629?q=80&w=2000" class="w-full h-full object-cover editable-img">
                <div class="absolute inset-0 z-20 flex flex-col items-center justify-center text-center px-4" data-aos="zoom-in">
                    <span class="text-svm-gold font-bold tracking-[0.2em] text-[10px] uppercase mb-2 border border-svm-gold/30 px-3 py-1 rounded-full backdrop-blur-sm">SVM Academy</span>
                    <h2 class="font-serif text-4xl md:text-6xl font-bold text-white mb-4 editable" id="training-title">School of Champions</h2>
                    <p class="text-slate-300 max-w-md text-sm md:text-base font-light leading-relaxed editable" id="training-desc">Membentuk karakter pemenang melalui kedisiplinan.</p>
                </div>
            </div>

            <section class="max-w-7xl mx-auto px-4 py-16">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <!-- Curriculum -->
                    <div class="md:col-span-2 space-y-4">
                        <h3 class="font-display text-xl font-bold text-svm-dark mb-4 border-l-4 border-svm-gold pl-3">Kurikulum Berjenjang</h3>
                        
                        <div class="bg-slate-50 p-6 rounded-2xl border border-slate-100 hover:border-svm-gold transition duration-300 group">
                            <div class="flex gap-4">
                                <div class="font-display text-3xl font-bold text-slate-200 group-hover:text-svm-gold transition">01</div>
                                <div>
                                    <h4 class="font-bold text-sm md:text-base text-svm-dark editable" id="curr-1-title">Basic Fundamental</h4>
                                    <p class="text-xs text-slate-500 leading-relaxed mt-1 editable" id="curr-1-desc">Pondasi utama. Fokus pada fisik, PBB, dan teknik dasar.</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-slate-50 p-6 rounded-2xl border border-slate-100 hover:border-svm-gold transition duration-300 group">
                            <div class="flex gap-4">
                                <div class="font-display text-3xl font-bold text-slate-200 group-hover:text-svm-gold transition">02</div>
                                <div>
                                    <h4 class="font-bold text-sm md:text-base text-svm-dark editable" id="curr-2-title">Music & Harmony</h4>
                                    <p class="text-xs text-slate-500 leading-relaxed mt-1 editable" id="curr-2-desc">Not balok, lagu, intonasi dan tuning presisi.</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-slate-50 p-6 rounded-2xl border border-slate-100 hover:border-svm-gold transition duration-300 group">
                            <div class="flex gap-4">
                                <div class="font-display text-3xl font-bold text-slate-200 group-hover:text-svm-gold transition">03</div>
                                <div>
                                    <h4 class="font-bold text-sm md:text-base text-svm-dark editable" id="curr-3-title">Display & Visual</h4>
                                    <p class="text-xs text-slate-500 leading-relaxed mt-1 editable" id="curr-3-desc">Formasi lapangan (drill) dan koreografi color guard.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Schools List -->
                    <div class="bg-svm-navy text-white p-6 rounded-2xl relative overflow-hidden h-fit">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-svm-gold rounded-full mix-blend-overlay filter blur-3xl opacity-20"></div>
                        <div class="flex justify-between items-center mb-6 relative z-10">
                            <h3 class="font-display text-lg font-bold text-svm-gold">Sekolah Binaan</h3>
                            <button onclick="admin.addSchool()" class="admin-only hidden text-[10px] bg-white text-svm-dark px-2 py-1 rounded hover:bg-slate-200">+ Edit</button>
                        </div>
                        <ul id="schoolList" class="space-y-3 relative z-10 text-xs font-light text-slate-300"><!-- JS Generated --></ul>
                    </div>
                </div>
            </section>
        </div>

        <!-- === PAGE 3: KATALOG === -->
        <div id="page-catalog" class="page-section hidden fade-in bg-white">
            <div class="pt-28 pb-8 bg-slate-50 px-4 mb-4">
                <div class="max-w-7xl mx-auto text-center">
                    <h2 class="font-serif text-2xl md:text-4xl font-bold text-svm-dark mb-2">Katalog Premium</h2>
                    <p class="text-xs text-slate-500">Standar kompetisi nasional & internasional.</p>
                </div>
            </div>

            <div class="sticky top-16 md:top-20 z-30 bg-white/90 backdrop-blur-md border-b border-slate-100 py-3 px-4 mb-8">
                <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-3">
                    <div class="flex overflow-x-auto gap-2 w-full md:w-auto pb-1 scrollbar-hide" id="catalogTabs">
                        <button onclick="catalog.filter('all')" class="active-tab px-4 py-1.5 rounded-full text-[10px] font-bold transition border whitespace-nowrap">Semua</button>
                        <button onclick="catalog.filter('paket')" class="bg-white text-slate-600 px-4 py-1.5 rounded-full text-[10px] font-bold transition border border-slate-200 whitespace-nowrap">Paket</button>
                        <button onclick="catalog.filter('perkusi')" class="bg-white text-slate-600 px-4 py-1.5 rounded-full text-[10px] font-bold transition border border-slate-200 whitespace-nowrap">Perkusi</button>
                        <button onclick="catalog.filter('brass')" class="bg-white text-slate-600 px-4 py-1.5 rounded-full text-[10px] font-bold transition border border-slate-200 whitespace-nowrap">Brass</button>
                    </div>
                    <div class="relative w-full md:w-48">
                        <i class="fa-solid fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 text-xs"></i>
                        <input type="text" id="searchCatalog" onkeyup="catalog.search()" placeholder="Cari alat..." class="bg-slate-100 border-none rounded-full pl-8 pr-4 py-2 text-xs w-full focus:ring-1 focus:ring-svm-gold transition">
                    </div>
                </div>
            </div>

            <div class="max-w-7xl mx-auto px-4 pb-24">
                <button onclick="ui.showProductModal()" class="admin-only hidden w-full py-4 border-2 border-dashed border-slate-200 rounded-xl text-slate-400 font-bold mb-8 hover:border-svm-gold hover:text-svm-gold transition bg-slate-50 text-xs">
                    + Tambah Produk Baru
                </button>
                <div id="productGrid" class="grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-6"><!-- JS Rendered --></div>
            </div>
        </div>

    </main>

    <!-- FOOTER (Bottom Nav for Mobile) -->
    <div class="md:hidden fixed bottom-0 w-full bg-white/90 backdrop-blur-md border-t border-slate-200 flex justify-around py-3 z-40 text-[10px] font-bold text-slate-400 safe-area-pb">
        <button onclick="router.navigate('home')" class="flex flex-col items-center gap-1 active:text-svm-gold"><i class="fa-solid fa-home text-lg"></i> Home</button>
        <button onclick="router.navigate('training')" class="flex flex-col items-center gap-1 active:text-svm-gold"><i class="fa-solid fa-graduation-cap text-lg"></i> Academy</button>
        <button onclick="router.navigate('catalog')" class="flex flex-col items-center gap-1 active:text-svm-gold"><i class="fa-solid fa-store text-lg"></i> Shop</button>
    </div>

    <!-- MAIN FOOTER -->
    <footer class="bg-svm-dark text-white pt-16 pb-24 md:pb-8 border-t-4 border-svm-gold">
        <div class="max-w-7xl mx-auto px-4 grid grid-cols-1 md:grid-cols-4 gap-8 mb-12 text-center md:text-left">
            <div class="md:col-span-1">
                <h3 class="font-display font-bold text-2xl mb-4">SVM <span class="text-svm-gold">CORP.</span></h3>
                <p class="editable text-slate-400 text-xs leading-relaxed mb-6 font-light" id="footer-desc">Solusi alat musik & pelatihan terbaik di Kepulauan Riau.</p>
                <div class="flex justify-center md:justify-start gap-3">
                    <a href="https://wa.me/6283812113160" class="w-8 h-8 rounded-full border border-white/20 flex items-center justify-center hover:bg-green-600 transition text-white text-xs"><i class="fa-brands fa-whatsapp"></i></a>
                    <a href="#" class="w-8 h-8 rounded-full border border-white/20 flex items-center justify-center hover:bg-pink-600 transition text-white text-xs"><i class="fa-brands fa-instagram"></i></a>
                    <a href="#" class="w-8 h-8 rounded-full border border-white/20 flex items-center justify-center hover:bg-red-600 transition text-white text-xs"><i class="fa-brands fa-youtube"></i></a>
                </div>
            </div>
            
            <div class="md:col-span-1">
                <h4 class="font-bold mb-4 text-xs uppercase tracking-wider text-svm-gold">Lokasi</h4>
                <div class="rounded-xl overflow-hidden border border-white/20 h-32 w-full bg-slate-800">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3989.002879220142!2d104.03262877496546!3d1.1584165988305037!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31d9896471d9bf61%3A0x3ba836b339405c33!2smarching%20band%20batam%20SVM!5e0!3m2!1sid!2sid" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                </div>
            </div>

            <div>
                <h4 class="font-bold mb-4 text-xs uppercase tracking-wider text-svm-gold">Kontak</h4>
                <ul class="space-y-3 text-xs text-slate-400 font-light">
                    <li class="flex gap-3 justify-center md:justify-start"><i class="fa-solid fa-location-dot mt-1 text-svm-gold"></i> <span class="editable" id="footer-addr">Bengkong, Batam, Kepri</span></li>
                    <li class="flex gap-3 justify-center md:justify-start"><i class="fa-brands fa-whatsapp mt-1 text-svm-gold"></i> <span class="editable" id="footer-wa">0838-1211-3160</span></li>
                </ul>
            </div>
        </div>
        <div class="text-center text-[10px] text-slate-600 pt-6 border-t border-white/5 uppercase tracking-widest">&copy; 2026 PT. SVM.</div>
    </footer>

    <!-- === MODALS === -->
    
    <!-- Admin Toolbar -->
    <div id="adminToolbar" class="fixed bottom-20 md:bottom-6 left-1/2 transform -translate-x-1/2 bg-svm-dark/90 backdrop-blur-md text-white px-4 py-2 rounded-full shadow-2xl z-50 items-center gap-4 hidden border border-white/20">
        <span class="text-[10px] font-bold text-svm-gold">ADMIN</span>
        <div class="h-4 w-px bg-white/20"></div>
        <button onclick="admin.createLink()" class="hover:text-blue-400 text-lg transition" title="Link WA"><i class="fa-solid fa-link"></i></button>
        <button onclick="ui.showVideoModal()" class="hover:text-red-400 text-lg transition" title="YouTube"><i class="fa-brands fa-youtube"></i></button>
        <button onclick="admin.saveAllChanges()" class="hover:text-green-400 text-lg transition" title="Save Text"><i class="fa-solid fa-save"></i></button>
        <button onclick="ui.showProductModal()" class="hover:text-yellow-400 text-lg transition" title="Add Product"><i class="fa-solid fa-plus-circle"></i></button>
        <button onclick="aiHelper.generateQuote()" class="hover:text-purple-400 text-lg transition" title="AI Assistant"><i class="fa-solid fa-wand-magic-sparkles"></i></button>
        <div class="h-4 w-px bg-white/20"></div>
        <button onclick="auth.logout()" class="hover:text-red-500 text-lg transition" title="Logout"><i class="fa-solid fa-power-off"></i></button>
    </div>

    <!-- Image Upload Modal (AUTO SAVE) -->
    <div id="imageModal" class="fixed inset-0 bg-svm-dark/80 backdrop-blur-md hidden items-center justify-center z-[80] p-4">
        <div class="bg-white p-6 rounded-3xl w-full max-w-sm shadow-2xl relative overflow-hidden">
            <button onclick="ui.closeModal('imageModal')" class="absolute top-4 right-4 text-slate-300 hover:text-red-500"><i class="fa-solid fa-times"></i></button>
            <h2 class="text-lg font-display font-bold mb-4 text-center text-svm-dark">Update File / Foto</h2>
            
            <div id="imgDropZone" class="h-32 rounded-xl border-2 border-dashed border-svm-gold bg-yellow-50/50 flex flex-col items-center justify-center cursor-pointer hover:bg-yellow-50 transition mb-4 relative">
                <img id="editImgPreview" class="absolute inset-0 w-full h-full object-contain hidden bg-white p-2 rounded-xl">
                <i class="fa-solid fa-cloud-arrow-up text-3xl text-svm-gold mb-2"></i>
                <p class="text-[10px] text-slate-500 font-bold uppercase tracking-wide">Pilih File dari HP/Laptop</p>
                <input type="file" id="imgFileInput" class="absolute inset-0 opacity-0 cursor-pointer" accept="image/*">
            </div>
            
            <div class="text-center text-[10px] text-slate-400 mb-2 font-bold">- ATAU TEMPEL LINK -</div>
            
            <input type="text" id="imgUrlInput" class="w-full bg-slate-50 border border-slate-200 p-3 rounded-xl text-xs focus:ring-2 focus:ring-svm-gold outline-none mb-2" placeholder="Paste Link Google Drive / Gambar disini...">
            
            <input type="hidden" id="targetImgId">
            <p id="saveStatus" class="text-[10px] text-center text-slate-400 font-bold h-4"></p>
        </div>
    </div>

    <!-- Video & Product Modals (Simplified for brevity but fully functional) -->
    <div id="videoModal" class="fixed inset-0 bg-svm-dark/80 backdrop-blur-md hidden items-center justify-center z-[80] p-4">
        <div class="bg-white p-6 rounded-3xl w-full max-w-sm shadow-2xl">
            <h2 class="text-lg font-bold mb-4">Tambah Video Youtube</h2>
            <input type="text" id="vidTitle" class="w-full border p-2 rounded-lg text-xs mb-2" placeholder="Judul">
            <input type="text" id="vidUrl" class="w-full border p-2 rounded-lg text-xs mb-2" placeholder="Link Youtube">
            <input type="text" id="vidDesc" class="w-full border p-2 rounded-lg text-xs mb-4" placeholder="Deskripsi">
            <button onclick="videos.add()" class="w-full bg-red-600 text-white py-2 rounded-lg font-bold text-xs">Simpan Video</button>
            <button onclick="ui.closeModal('videoModal')" class="w-full mt-2 text-slate-400 text-xs">Batal</button>
        </div>
    </div>

    <div id="productModal" class="fixed inset-0 bg-svm-dark/80 backdrop-blur-md hidden items-center justify-center z-[80] p-4">
        <div class="bg-white p-6 rounded-3xl w-full max-w-md max-h-[90vh] overflow-y-auto shadow-2xl">
            <h2 class="text-lg font-bold mb-4">Edit Katalog</h2>
            <input type="hidden" id="prodId">
            <div class="grid grid-cols-2 gap-4">
                <div id="dropZone" class="h-32 border-2 border-dashed border-slate-300 rounded-xl flex items-center justify-center relative bg-slate-50 cursor-pointer">
                    <p class="text-[10px] text-slate-400">Upload Foto</p>
                    <img id="imgPreview" class="absolute inset-0 w-full h-full object-contain hidden bg-white p-1">
                    <input type="file" id="fileInput" class="absolute inset-0 opacity-0 cursor-pointer" accept="image/*">
                    <input type="hidden" id="prodImageBase64">
                </div>
                <div class="space-y-2">
                    <input type="text" id="prodName" class="w-full border p-2 rounded-lg text-xs" placeholder="Nama Produk">
                    <input type="text" id="prodPrice" class="w-full border p-2 rounded-lg text-xs" placeholder="Harga">
                    <select id="prodCategory" class="w-full border p-2 rounded-lg text-xs">
                        <option value="paket">Paket Sekolah</option>
                        <option value="perkusi">Perkusi</option>
                        <option value="brass">Brass</option>
                        <option value="colorguard">Color Guard</option>
                    </select>
                </div>
            </div>
            <textarea id="prodDesc" class="w-full border p-2 rounded-lg text-xs mt-2" rows="2" placeholder="Deskripsi"></textarea>
            <div class="flex items-center gap-2 mt-2">
                <input type="checkbox" id="prodBest"> <label for="prodBest" class="text-xs">Best Seller?</label>
            </div>
            <button onclick="catalog.saveProduct()" class="w-full bg-svm-dark text-white py-2 rounded-lg font-bold text-xs mt-4">Simpan Produk</button>
            <button onclick="ui.closeModal('productModal')" class="w-full mt-2 text-slate-400 text-xs">Batal</button>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-svm-dark/90 backdrop-blur-sm hidden items-center justify-center z-[60] p-4">
        <div class="bg-white p-8 rounded-3xl w-full max-w-sm shadow-2xl animate-float">
            <h2 class="text-xl font-bold mb-6 text-center">Admin Access</h2>
            <input type="email" id="email" class="w-full border p-3 rounded-xl mb-3 text-sm" placeholder="Email">
            <input type="password" id="password" class="w-full border p-3 rounded-xl mb-6 text-sm" placeholder="Password">
            <div class="flex gap-2">
                <button onclick="ui.closeModal('loginModal')" class="flex-1 py-2 text-slate-500 text-sm">Batal</button>
                <button onclick="auth.login()" class="flex-1 py-2 bg-svm-dark text-white rounded-xl font-bold text-sm">Masuk</button>
            </div>
        </div>
    </div>

    <!-- LOGIC -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, getDocs, addDoc, deleteDoc, doc, updateDoc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        AOS.init({ once: true, offset: 20, duration: 600 });

        const firebaseConfig = {
            apiKey: "AIzaSyAo_DL6ge2m7KXz67vcDA4fA4LabqE00uk",
            authDomain: "marchingbatam.firebaseapp.com",
            projectId: "marchingbatam",
            storageBucket: "marchingbatam.firebasestorage.app",
            messagingSenderId: "597539177591",
            appId: "1:597539177591:web:8fe5b34422d792b40c3272"
        };

        let app, auth, db;
        try { app = initializeApp(firebaseConfig); auth = getAuth(app); db = getFirestore(app); } catch(e) {}

        let currentUser = null;
        let productsCache = [];
        let activeEditableElement = null;

        // --- AI HELPER (MOTIVATION) ---
        const quotes = [
            "Investasi alat musik adalah investasi karakter. Jadikan sekolah Anda pusat kreativitas Batam hari ini.",
            "Marching Band bukan sekadar musik, tapi tentang kedisiplinan dan kebanggaan sekolah.",
            "Alat berkualitas menciptakan harmoni yang sempurna. Upgrade unit Anda bersama SVM.",
            "Prestasi lahir dari persiapan yang matang. Lengkapi fasilitas sekolah Anda sekarang.",
            "Musik menyatukan perbedaan. Biarkan siswa Anda bersinar di panggung kompetisi."
        ];

        window.aiHelper = {
            init: () => {
                // Auto rotate daily based on date
                const today = new Date().getDate();
                const quoteIndex = today % quotes.length;
                const quoteEl = document.getElementById('dailyQuote');
                if(quoteEl) quoteEl.innerText = `"${quotes[quoteIndex]}"`;
            },
            generateQuote: () => {
                // Admin can random regenerate
                if(!currentUser) return;
                const random = Math.floor(Math.random() * quotes.length);
                const quoteEl = document.getElementById('dailyQuote');
                if(quoteEl) {
                    quoteEl.innerText = `"${quotes[random]}"`;
                    // Optional: Save to DB logic here if needed
                    Swal.fire({icon: 'success', title: 'Kata Motivasi Diperbarui!', timer: 1000, showConfirmButton: false});
                }
            }
        };

        // --- COMPRESSION ---
        const compressImage = async (file) => {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = (event) => {
                    const img = new Image();
                    img.src = event.target.result;
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        const maxWidth = 800; 
                        const scaleSize = maxWidth / img.width;
                        canvas.width = maxWidth;
                        canvas.height = img.height * scaleSize;
                        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                        resolve(canvas.toDataURL('image/jpeg', 0.7)); 
                    };
                };
            });
        };

        window.auth = {
            login: async () => {
                try {
                    await signInWithEmailAndPassword(auth, document.getElementById('email').value, document.getElementById('password').value);
                    ui.closeModal('loginModal');
                    Swal.fire({icon:'success', title:'Mode Admin Aktif', timer:1000, showConfirmButton:false});
                } catch (e) { Swal.fire('Gagal', 'Email/Password salah', 'error'); }
            },
            logout: async () => { await signOut(auth); location.reload(); }
        };

        // --- AUTO SAVE IMAGES ---
        window.images = {
            currentId: null,
            init: () => {
                admin.loadImages();
                if(currentUser) {
                    document.querySelectorAll('.editable-img').forEach(img => {
                        if(img.dataset.bound === "true") return;
                        img.dataset.bound = "true";
                        img.addEventListener('click', function(e) {
                            e.preventDefault(); e.stopPropagation();
                            window.images.currentId = this.id;
                            document.getElementById('editImgPreview').classList.add('hidden');
                            document.getElementById('imgFileInput').value = '';
                            document.getElementById('imgUrlInput').value = '';
                            document.getElementById('saveStatus').innerHTML = '';
                            if(!window.images.currentId) return;
                            ui.showImageModal();
                        });
                    });
                }
            },
            save: async (directFile = null, directUrl = null) => {
                const targetId = window.images.currentId;
                if(!targetId) return;
                
                const statusEl = document.getElementById('saveStatus');
                if(statusEl) statusEl.innerHTML = '<span class="text-svm-gold animate-pulse">Menyimpan otomatis...</span>';

                try {
                    let finalSrc = directUrl;
                    if (directFile) finalSrc = await compressImage(directFile);
                    else if (!directUrl) return;

                    const imgEl = document.getElementById(targetId);
                    if(imgEl) { imgEl.src = finalSrc; }

                    await setDoc(doc(db, 'site_images', targetId), { base64: finalSrc, updatedAt: new Date() }, { merge: true });
                    
                    if(statusEl) statusEl.innerHTML = '<span class="text-green-500">Tersimpan!</span>';
                    setTimeout(() => { ui.closeModal('imageModal'); }, 800);
                } catch(e) { if(statusEl) statusEl.innerText = "Gagal simpan."; }
            }
        };

        // Auto Save Listener
        document.addEventListener('DOMContentLoaded', () => {
            const urlInput = document.getElementById('imgUrlInput');
            if(urlInput) {
                urlInput.addEventListener('input', (e) => {
                    const val = e.target.value.trim();
                    if(val.length > 10 && (val.startsWith('http') || val.startsWith('data:'))) {
                        clearTimeout(window.saveTimeout);
                        window.saveTimeout = setTimeout(() => window.images.save(null, val), 500);
                    }
                });
            }
        });

        // --- CATALOG LOGIC ---
        const defaultCatalog = [
            { id: "d1", name: "Snare HTS Premium 14\"", category: "perkusi", price: "Hubungi Admin", description: "Shell Maple 7-ply. Suara tajam kompetisi.", isBest: true, image: "https://images.unsplash.com/photo-1519892300165-cb5542fb47c7?q=80&w=400" },
            { id: "d2", name: "Marching Bell Lyra", category: "perkusi", price: "Hubungi Admin", description: "Aluminium alloy, frame kokoh + harness.", image: "https://id-test-11.slatic.net/p/d9d201111663116631326262111.jpg" },
            { id: "d5", name: "Trumpet Bb Gold", category: "brass", price: "Hubungi Admin", description: "Valve stainless steel, intonasi presisi.", isBest: true, image: "https://images.unsplash.com/photo-1573871669414-010dbf73ca84?q=80&w=400" },
            { id: "d6", name: "Digital Flag Custom", category: "colorguard", price: "Rp 185.000", description: "Desain custom (Giant, Swing, Standard).", isBest: true, image: "https://images.unsplash.com/photo-1532986409605-7284cc37482f?q=80&w=400" },
        ];

        window.catalog = {
            load: async () => {
                const grid = document.getElementById('productGrid');
                grid.innerHTML = '<div class="col-span-full py-10 flex justify-center"><i class="fa-solid fa-spinner fa-spin text-2xl text-svm-gold"></i></div>';
                try {
                    const snap = await getDocs(collection(db, "products"));
                    productsCache = snap.empty ? defaultCatalog : [];
                    snap.forEach(doc => productsCache.push({ id: doc.id, ...doc.data() }));
                } catch(e) { productsCache = defaultCatalog; }
                catalog.render(productsCache);
            },
            render: (products) => {
                const grid = document.getElementById('productGrid');
                grid.innerHTML = '';
                products.forEach((p) => {
                    const adminBtns = currentUser ? `<button onclick="catalog.delete('${p.id}')" class="absolute top-2 right-2 bg-red-500 text-white w-6 h-6 rounded-full shadow z-20 hover:scale-110 flex items-center justify-center text-xs"><i class="fa-solid fa-trash"></i></button>` : '';
                    const bestBadge = p.isBest ? `<span class="absolute top-2 left-2 bg-yellow-400 text-white text-[9px] font-bold px-2 py-0.5 rounded shadow z-10"><i class="fa-solid fa-star"></i> BEST</span>` : '';
                    
                    grid.innerHTML += `
                        <div class="group bg-white rounded-xl p-3 shadow-sm hover:shadow-lg transition duration-300 relative border border-slate-100 flex flex-col h-full">
                            ${adminBtns} ${bestBadge}
                            <div class="rounded-lg overflow-hidden bg-slate-50 aspect-square mb-3 relative">
                                <img src="${p.image || 'https://placehold.co/400'}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                            </div>
                            <div class="flex-1 flex flex-col">
                                <span class="text-[9px] font-bold text-svm-gold uppercase mb-1">${p.category}</span>
                                <h3 class="font-bold text-svm-dark text-xs md:text-sm leading-tight mb-1 line-clamp-2">${p.name}</h3>
                                <p class="text-[10px] text-slate-400 mb-2 line-clamp-2">${p.description || ''}</p>
                                <div class="mt-auto pt-2 border-t border-slate-50 flex items-center justify-between">
                                    <p class="text-svm-dark font-bold text-xs">${p.price}</p>
                                    <a href="https://wa.me/6283812113160?text=Info%20${encodeURIComponent(p.name)}" target="_blank" class="w-6 h-6 rounded-full bg-slate-100 flex items-center justify-center hover:bg-green-500 hover:text-white transition text-xs"><i class="fa-brands fa-whatsapp"></i></a>
                                </div>
                            </div>
                        </div>
                    `;
                });
            },
            filter: (cat) => {
                document.querySelectorAll('#catalogTabs button').forEach(b => {
                    b.classList.remove('active-tab', 'text-svm-gold'); b.classList.add('bg-white', 'text-slate-600');
                    if(b.textContent.toLowerCase().includes(cat) || (cat === 'all' && b.textContent === 'Semua')) {
                         b.classList.add('active-tab', 'text-svm-gold'); b.classList.remove('bg-white', 'text-slate-600');
                    }
                });
                catalog.render(cat === 'all' ? productsCache : productsCache.filter(p => p.category === cat));
            },
            search: () => {
                const k = document.getElementById('searchCatalog').value.toLowerCase();
                catalog.render(productsCache.filter(p => p.name.toLowerCase().includes(k)));
            },
            delete: async (id) => { if(currentUser && confirm('Hapus?')) { await deleteDoc(doc(db, "products", id)); catalog.load(); } },
            saveProduct: async () => {
                const data = {
                    name: document.getElementById('prodName').value,
                    price: document.getElementById('prodPrice').value,
                    category: document.getElementById('prodCategory').value,
                    description: document.getElementById('prodDesc').value,
                    image: document.getElementById('prodImageBase64').value,
                    isBest: document.getElementById('prodBest').checked
                };
                if(data.name) { await addDoc(collection(db, "products"), data); ui.closeModal('productModal'); catalog.load(); }
            }
        };

        window.videos = {
            load: async () => {
                const grid = document.getElementById('videoGrid');
                let vidData = [];
                try {
                    const snap = await getDocs(collection(db, "videos"));
                    if (snap.empty) {
                        vidData = [
                            {url:"https://www.youtube.com/watch?v=RxFHL83srDg", title:"MIMAC 2024 Champion", desc:"Color Guard Malaysia"},
                            {url:"https://www.youtube.com/watch?v=x7mk3HH8n_o", title:"Konser SMAN 20", desc:"Culture Fest"},
                            {url:"https://www.youtube.com/watch?v=TL8uWmriYK4", title:"Drum Battle", desc:"International Final"}
                        ];
                    } else { vidData = snap.docs.map(d => ({id: d.id, ...d.data()})); }
                } catch(e) { vidData = []; }
                
                grid.innerHTML = '';
                vidData.forEach(v => {
                    let videoId = 'dQw4w9WgXcQ';
                    if (v.url.includes('youtu.be/')) videoId = v.url.split('youtu.be/')[1].split('?')[0];
                    else if (v.url.includes('v=')) videoId = v.url.split('v=')[1].split('&')[0];
                    const thumb = `https://img.youtube.com/vi/${videoId}/mqdefault.jpg`;
                    const delBtn = currentUser ? `<button onclick="videos.delete('${v.id}')" class="absolute top-2 right-2 bg-red-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs"><i class="fa-solid fa-trash"></i></button>` : '';
                    
                    grid.innerHTML += `
                        <div class="relative group block rounded-xl overflow-hidden shadow-md">
                            ${delBtn}
                            <a href="${v.url}" target="_blank">
                                <img src="${thumb}" class="w-full h-32 object-cover opacity-90 group-hover:opacity-100 transition">
                                <div class="absolute inset-0 bg-black/20 flex items-center justify-center"><i class="fa-solid fa-play text-white text-2xl"></i></div>
                                <div class="bg-white p-3">
                                    <h3 class="font-bold text-xs text-svm-dark truncate">${v.title}</h3>
                                    <p class="text-[10px] text-slate-500 truncate">${v.desc}</p>
                                </div>
                            </a>
                        </div>
                    `;
                });
            },
            add: async () => {
                const data = { title: document.getElementById('vidTitle').value, url: document.getElementById('vidUrl').value, desc: document.getElementById('vidDesc').value };
                if(data.url) { await addDoc(collection(db, "videos"), data); ui.closeModal('videoModal'); videos.load(); }
            },
            delete: async (id) => { if(confirm('Hapus?')) { await deleteDoc(doc(db, "videos", id)); videos.load(); } }
        };

        window.schools = {
            load: async () => {
                const list = document.getElementById('schoolList');
                list.innerHTML = '';
                const defaults = ["SMAN 20 Batam", "MTsN 1 Batam", "MIN 1 Batam", "SDN 06 Sei Beduk"];
                try {
                    const snap = await getDocs(collection(db, "schools"));
                    if(snap.empty) defaults.forEach(s => schools.appendHTML(s));
                    else snap.forEach(doc => schools.appendHTML(doc.data().name, doc.id));
                } catch { defaults.forEach(s => schools.appendHTML(s)); }
            },
            appendHTML: (name, id) => {
                const btn = currentUser ? `<button onclick="schools.remove('${id}')" class="text-red-300 ml-auto text-xs"><i class="fa-solid fa-trash"></i></button>` : '';
                document.getElementById('schoolList').innerHTML += `<li class="flex items-center text-slate-200 py-2 border-b border-white/5"><i class="fa-solid fa-check text-svm-gold mr-3 text-xs"></i> ${name} ${btn}</li>`;
            },
            remove: async (id) => { if(currentUser) { await deleteDoc(doc(db,"schools",id)); schools.load(); } }
        };

        window.admin = {
            saveAllChanges: async () => {
                const updates = {};
                document.querySelectorAll('.editable').forEach(el => updates[el.id] = el.innerHTML);
                await setDoc(doc(db, "config", "content"), updates);
                Swal.fire({icon: 'success', title: 'Tersimpan!', timer: 800, showConfirmButton: false});
            },
            loadTextConfig: async () => {
                try {
                    const d = await getDoc(doc(db, "config", "content"));
                    if(d.exists()) Object.entries(d.data()).forEach(([k,v]) => { if(document.getElementById(k)) document.getElementById(k).innerHTML = v; });
                } catch {}
            },
            loadImages: async () => {
                try {
                    const snap = await getDocs(collection(db, "site_images"));
                    snap.forEach(doc => {
                        const img = document.getElementById(doc.id);
                        if(img && doc.data().base64) img.src = doc.data().base64;
                    });
                } catch(e) {}
            },
            loadLinks: async () => {
                try {
                    const snap = await getDocs(collection(db, "site_links"));
                    snap.forEach(doc => {
                        const linkEl = document.getElementById(doc.id);
                        if(linkEl && doc.data().url) linkEl.href = doc.data().url;
                    });
                } catch(e) {}
            },
            editLink: async (elementId) => {
                if(!currentUser) return;
                const { value: url } = await Swal.fire({ input: 'url', inputLabel: 'Paste Link PDF / Google Drive', showCancelButton: true });
                if (url) {
                    const linkEl = document.getElementById(elementId);
                    if(linkEl) linkEl.href = url;
                    await setDoc(doc(db, 'site_links', elementId), { url: url }, { merge: true });
                    Swal.fire({icon: 'success', title: 'Link Disimpan!', timer: 800, showConfirmButton: false});
                }
            },
            addSchool: async () => {
                const {value:name} = await Swal.fire({input:'text', title:'Tambah Sekolah'});
                if(name) { await addDoc(collection(db,"schools"),{name}); schools.load(); }
            },
            createLink: async () => {
                if(!activeEditableElement) return;
                const { value: url } = await Swal.fire({ input: 'url', inputLabel: 'Link URL', showCancelButton: true });
                if (url) {
                    activeEditableElement.innerHTML = `<a href="${url}" target="_blank" class="text-svm-gold hover:underline">${activeEditableElement.innerText}</a>`;
                }
            }
        };

        window.ui = {
            showLoginModal: () => document.getElementById('loginModal').classList.remove('hidden'),
            showProductModal: () => document.getElementById('productModal').classList.remove('hidden'),
            showVideoModal: () => document.getElementById('videoModal').classList.remove('hidden'),
            showImageModal: () => document.getElementById('imageModal').classList.remove('hidden'),
            closeModal: (id) => document.getElementById(id).classList.add('hidden')
        };

        // --- FILE HANDLER & AUTO SAVE ---
        function setupDropZone(dzId, inputId, previewId, valInputId, isGeneralImage = false) {
            const dz = document.getElementById(dzId);
            const fi = document.getElementById(inputId);
            if(!dz || !fi) return;
            dz.onclick = () => fi.click();
            fi.onchange = (e) => processFile(e.target.files[0], previewId, valInputId, isGeneralImage);
            dz.addEventListener('dragover', (e)=>{e.preventDefault(); dz.classList.add('bg-svm-gold/20')});
            dz.addEventListener('dragleave', ()=>{dz.classList.remove('bg-svm-gold/20')});
            dz.addEventListener('drop', (e)=>{ e.preventDefault(); dz.classList.remove('bg-svm-gold/20'); processFile(e.dataTransfer.files[0], previewId, valInputId, isGeneralImage); });
        }

        async function processFile(f, previewId, valInputId, isGeneralImage) {
            if(!f || !f.type.startsWith('image/')) return;
            if(isGeneralImage) { window.images.save(f, null); return; } // Auto save for site images
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = document.getElementById(previewId);
                img.src = e.target.result;
                img.classList.remove('hidden');
                if(valInputId) compressImage(f).then(base64 => document.getElementById(valInputId).value = base64);
            };
            reader.readAsDataURL(f);
        }

        setupDropZone('dropZone', 'fileInput', 'imgPreview', 'prodImageBase64', false); 
        setupDropZone('imgDropZone', 'imgFileInput', 'editImgPreview', null, true);   

        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            if (user) {
                document.body.classList.add('admin-mode');
                document.getElementById('btnLogin').classList.add('hidden');
                document.getElementById('adminBadge').classList.remove('hidden');
                document.getElementById('adminBadge').classList.add('flex');
                document.querySelectorAll('.editable').forEach(el => {
                    el.contentEditable = "true";
                    el.addEventListener('click', function() { activeEditableElement = this; });
                });
                document.querySelectorAll('.admin-only').forEach(el => el.classList.remove('hidden'));
                setTimeout(images.init, 1000); 
            } else {
                document.body.classList.remove('admin-mode');
                document.getElementById('btnLogin').classList.remove('hidden');
                document.getElementById('adminBadge').classList.add('hidden');
                document.getElementById('adminBadge').classList.remove('flex');
                document.querySelectorAll('.editable').forEach(el => el.contentEditable = "false");
                document.querySelectorAll('.admin-only').forEach(el => el.classList.add('hidden'));
            }
            catalog.load();
            videos.load();
            schools.load();
            admin.loadTextConfig();
            admin.loadImages();
            admin.loadLinks();
            aiHelper.init();
        });

        window.router = {
            navigate: (pageId) => {
                document.querySelectorAll('.page-section').forEach(el => el.classList.add('hidden'));
                document.getElementById(`page-${pageId}`).classList.remove('hidden');
                window.scrollTo(0,0);
            }
        };
        
        window.addEventListener('scroll', () => {
            const nav = document.getElementById('navbar');
            if (window.scrollY > 50) { nav.classList.add('py-2'); nav.classList.remove('py-4'); } 
            else { nav.classList.add('py-4'); nav.classList.remove('py-2'); }
        });

        setTimeout(() => catalog.filter('all'), 500);
        router.navigate('home');
    </script>
</body>
</html>

